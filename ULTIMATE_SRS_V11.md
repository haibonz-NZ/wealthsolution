# 跨国家族办公室智能报告系统 - 软件需求规格说明书 (SRS V11.0)

**版本号**：V11.0
**密级**：绝密 (Top Secret)
**适用范围**：开发、测试、UI设计、产品验收
**文档说明**：本文档详尽定义了 GWRC 系统（客户端 C-End + 顾问端 B-End）的每一个页面、每一个功能点、每一个逻辑判断及数据交互标准。

---

# 📱 第一部分：客户前台 (C-End Client Facing)

**核心目标**：通过视觉震撼与隐私保护，引导高净值客户完成资产自查并留资。
**技术栈**：React, Tailwind CSS, Framer Motion, Recharts, LocalStorage (无后端)

## 页面 1.1：门厅着陆页 (Landing Page)
**路由**：`/`
**功能**：品牌展示、信任建立、入口引导。

### 1.1.1 UI 元素清单
| 区域 | 元素名称 | 内容/文案 | 交互行为 | 备注 |
| :--- | :--- | :--- | :--- | :--- |
| **背景层** | 沉浸背景图 | 深蓝底色 + 古铜色经纬线网格 | 静态/微动效 | VI: #0C2340 (BG) |
| **顶部** | 滚动消息条 | "某上海籍家族刚刚完成美/日风险扫描..." | 自动横向滚动 (Marquee) | 营造活跃感 |
| | 安全浮窗 | 🛡️ "AES-256 加密 | 匿名访问" | 悬停显示隐私条款 Tips | 固定右上角 |
| **核心区** | Logo | The One Wealth Solutions (金字) | 淡入动画 (Fade In) | |
| | 主标题 | "预见跨境隐忧，守护家庭长青" | 字体：Cinzel (衬线体) | |
| | 副标题 | "基于大数据的智能化家庭财富体检方案" | 字体：Lato (非衬线) | |
| | CTA按钮 | [立即开启体检] | 点击 -> 跳转 `/wizard/identity` | 古铜色流光特效 |
| | 计数器 | "当前已有 1,284 位高净值客户完成自查" | 数字每 3 秒随机 +1 | 模拟实时数据 |
| **底部** | 顾问名片 | 头像 | 姓名 | 头衔 | 仅当 URL 含 `?advisor_id=x` 时显示 | 磨砂玻璃质感 |

### 1.1.2 逻辑说明
*   **顾问溯源**：页面加载时，解析 URL 参数 `advisor_id`。若存在，存入 `sessionStorage`，用于后续留资关联。若不存在，显示“官方顾问团队”。

---

## 页面 1.2：身份拓扑录入 (Identity Mapping)
**路由**：`/wizard/identity`
**功能**：采集家庭成员结构及其税务管辖区关联。

### 1.2.1 UI 元素清单
| 区域 | 元素名称 | 内容/文案 | 交互行为 | 备注 |
| :--- | :--- | :--- | :--- | :--- |
| **顶部** | 进度条 | "STEP 1/3" | 进度 33% | 古铜色细线 |
| **左侧/底** | 身份托盘 | 圆形图标：本人、配偶、子女、父母 | **可拖拽 (Draggable)** | 奶油色图标 |
| **中心** | 世界地图 | 8大热区：CN, US, UK, CA, AU, JP, HK, SG | **可投放 (Droppable)** | 深蓝地图底色 |
| **地图上** | 热区高亮 | 选中时显示国旗及已放入的角色头像 | 点击可删除角色 | |
| **底部** | 下一步按钮 | [下一步] | 点击 -> 跳转 `/wizard/assets` | 至少选1个才激活 |

### 1.2.2 核心业务逻辑：8国税务触发器 (Trigger Logic)
*当角色被拖入特定国家时，**立即弹出**模态框进行深度追问。*

#### **(A) 美国 (US) 逻辑链**
*   **弹窗标题**：美国税务深度扫描
*   **Q1**: "持有美国护照/绿卡？" (Yes/No) -> Yes 标记 `US_TAX_PERSON`
*   **Q2**: "过去3年累计居住满183天？" (Yes/No) -> Yes 标记 `SUBSTANTIAL_PRESENCE`
*   **Q3**: "是否持有非美籍亲属赠与的资产？" (Yes/No) -> Yes 标记 `GIFT_REPORTING` (3520表)
*   **Q4**: "是否持有非美公司股权(>10%)？" (Yes/No) -> Yes 标记 `CFC_RISK` (5471表)

#### **(B) 加拿大 (CA) / 澳大利亚 (AU) 逻辑链**
*   **弹窗标题**：离境/税务居民判定
*   **Q1**: "是否为税务居民？" (Yes/No)
*   **Q2**: "未来是否有长期离开该国的计划？" (Yes/No) -> Yes 标记 `DEPARTURE_TAX_RISK` (离境税)

#### **(C) 日本 (JP) 逻辑链**
*   **弹窗标题**：继承税连带责任判定
*   **Q1**: "在日本居住是否超过10年？" (Yes/No) -> Yes 标记 `JP_UNLIMITED_LIABILITY` (全球资产继承税)

#### **(D) 英国 (UK) 逻辑链**
*   **弹窗标题**：汇款制税务居民 (RND)
*   **Q1**: "是否为非居籍 (Non-Dom) 身份？" (Yes/No) -> Yes 标记 `UK_NON_DOM`

---

## 页面 1.3：资产画像速描 (Asset Profiling)
**路由**：`/wizard/assets`
**功能**：模糊采集资产体量与结构。

### 1.3.1 UI 元素清单
| 区域 | 元素名称 | 内容/文案 | 交互行为 | 备注 |
| :--- | :--- | :--- | :--- | :--- |
| **资产类型** | 多选卡片 | 房产、股权、现金、保单、信托、加密货币 | 点击选中 (高亮边框) | |
| **境内估值** | 滑块 (Slider) | <1000万 | 1000-5000万 | >1亿 | 拖动选择 | 对应人民币 |
| **境外估值** | 滑块 (Slider) | <100万 | 100-1000万 | >1000万 | 拖动选择 | 对应美元 |
| **底部** | 下一步按钮 | [下一步] | 点击 -> 跳转 `/wizard/pain-points` | |

---

## 页面 1.4：五维诊断中控台 (Diagnostic Dashboard)
**路由**：`/diagnosis`
**功能**：展示计算结果，震慑客户。

### 1.4.1 核心组件 A：五维雷达图
*   **维度**：税务、安全、传承、隐私、合规。
*   **算法**：
    *   初始分：100分。
    *   扣分项：
        *   `US_TAX_PERSON` -> 税务 -30, 合规 -20
        *   `CFC_RISK` -> 税务 -20, 安全 -10
        *   `JP_UNLIMITED_LIABILITY` -> 税务 -40
    *   **动画**：页面加载时，雷达图从满分状态迅速收缩至实际得分，配以红色闪烁特效。

### 1.4.2 核心组件 B：风险红绿灯 (Traffic Lights)
*   **展示**：垂直列表，每项一个卡片。
*   **状态**：
    *   🔴 **高危**：如 "美籍身份持有离岸信托" (风险: 3520A 罚款)。
    *   🟡 **预警**：如 "代持协议未公证"。
*   **交互**：点击卡片旁的 **💡小灯泡**，展开 Popover 显示：“根据美国 IRC 679 条款，未申报的外国信托将面临账户余额 35% 的罚款。”

### 1.4.3 核心组件 C：损益模拟器 (Loss Simulator)
*   **展示**：一个横向进度条，代表“财富传承剩余率”。
*   **计算逻辑**：
    *   `Total_Asset` = 境内 + 境外估值。
    *   `Loss_Estate` (遗产税) = US资产 * 40% + JP资产 * 55%。
    *   `Loss_Exit` (离境税) = CA/AU资产 * 25% (假设增值率50%)。
    *   `Loss_Legal` (纠纷) = 总资产 * 5%。
*   **动画**：进度条由绿色(100%) -> 被切掉一段变成红色 -> 剩余长度(例如 45%)。数字滚动显示：“预计代际损耗：$5,200,000”。

---

## 页面 1.5：解决方案与留资 (Solution & Lead Gen)
**路由**：`/solution`
**功能**：展示修复效果，获取销售线索。

### 1.5.1 UI 元素清单
| 区域 | 元素名称 | 内容/文案 | 交互行为 | 备注 |
| :--- | :--- | :--- | :--- | :--- |
| **顶部** | 修复开关 | "开启架构隔离保护" (Switch) | 点击 -> 触发绿屏动画 | |
| **对比区** | 前后对比 | 雷达图从“萎缩”变“饱满” | 动画过渡 | |
| **案例区** | 相似案例 | "刘先生(加拿大) 离境税筹划案例" | 点击 -> 弹出留资框 | 根据 tag 匹配 |
| **底部** | 获客按钮 | [获取完整落地执行方案] | 点击 -> 弹出手机号输入框 | |

### 1.5.2 留资逻辑
1.  **输入**：手机号 (必填)、验证码 (模拟)。
2.  **提交**：调用 API `/api/leads`。
3.  **Payload**：发送 `AdvisorID`, `Phone`, `RiskTags`, `AssetLevel`。
4.  **反馈**：显示“预约成功，顾问将在 24 小时内联系您”。

---

# 🖥️ 第二部分：顾问后台 (B-End Advisor Dashboard)

**核心目标**：接收线索，利用 AI 辅助生成深度报告。
**技术栈**：React, DeepSeek API, TipTap Editor

## 页面 2.1：顾问仪表盘 (Dashboard)
**路由**：`/dashboard`
**功能**：查看线索，管理案例。

### 2.1.1 功能列表
*   **线索收件箱**：列表展示来自 C 端的留资数据。
    *   列：时间、手机号、风险等级 (高/中/低)、资产规模、来源 (Link)。
    *   操作：[转为案例] -> 将 C 端数据导入 B 端数据库。
*   **一键导入演示**：点击按钮，自动创建一个包含 5 人、3 地资产的“李氏家族”标准案例 (用于演示给客户看)。

## 页面 2.2：智能报告生成器 (Report Generator)
**路由**：`/cases/:id/report`
**功能**：配置参数，调用 DeepSeek 生成内容。

### 2.2.1 侧重点配置面板 (Pre-Config)
*   **风格选择**：稳健 / 激进 / 中立。
*   **篇幅选择**：精简 (800字) / 详尽 (2000字)。
*   **强制动作**：点击 [开始生成] -> 锁定界面，显示“AI 正在思考...”动画。

### 2.2.2 报告编辑器 (The Editor)
*   **组件**：TipTap 富文本编辑器。
*   **结构**：
    *   **Part 1: 摘要** (可编辑文本框)。
    *   **Part 2: 家族图谱** (SVG 组件，不可编辑，但可缩放)。
    *   **Part 3: 资产分析** (Echarts 饼图/柱状图)。
    *   **Part 4: 风险剖析** (可编辑文本框)。
*   **AI 辅助**：选中文本 -> 悬浮菜单 -> [AI 润色] / [扩写] / [翻译]。

---

# 🔌 第三部分：数据字典与接口规范

## 3.1 风险标签字典 (Risk Tags Dictionary)
| 标签代码 | 含义 | 触发条件 (伪代码) | 风险等级 |
| :--- | :--- | :--- | :--- |
| `US_TAX_PERSON` | 美国税务居民 | Role.region == 'US' && (Citizen || Days>183) | 🔴 High |
| `US_PFIC` | 被动外国投资公司 | `US_TAX_PERSON` && Asset.type == 'Fund' | 🔴 High |
| `US_CFC` | 受控外国企业 | `US_TAX_PERSON` && Asset.type == 'Equity' (>10%) | 🔴 High |
| `CA_DEPARTURE` | 加拿大离境税 | Role.region == 'CA' && FuturePlan == 'Leave' | 🔴 High |
| `JP_INHERITANCE`| 日本继承税 | Role.region == 'JP' && ResidenceTime > 10yr | 🔴 High |
| `CN_CRS` | CRS信息交换 | Role.region == 'CN' && Asset.region != 'CN' | 🟡 Medium |

## 3.2 接口协议 (API Contract)

### POST `/api/generate` (Report Generation)
*   **Request**:
    ```json
    {
      "model": "deepseek-chat",
      "context": {
        "family": [...],
        "assets": [...],
        "risks": ["US_TAX_PERSON", "CA_DEPARTURE"] // 规则引擎预判结果
      },
      "config": { "tone": "professional", "length": "long" }
    }
    ```
*   **Response** (JSON Strict Mode):
    ```json
    {
      "summary": "...",
      "risk_analysis": "...",
      "conclusion": "..."
    }
    ```

---

**文档结语**：
本 SRS 文档已将需求细化至**原子级**。开发团队应严格遵循上述页面结构和逻辑定义进行编码，确保最终交付物与设计愿景完全一致。
